<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Penjana Prompt Penyelidikan</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      background-color: #f3f4f6;
      color: #1f2937;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      color: #1e40af;
      margin-bottom: 20px;
    }

    .section {
      margin-bottom: 20px;
    }

    .section h2 {
      font-size: 1.5rem;
      color: #1e40af;
      margin-bottom: 10px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
    }

    select, input[type="text"], textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 1rem;
    }

    .custom-input {
      margin-top: 10px;
    }

    .subject, .detail {
      border: 1px solid #e5e7eb;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    .button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .button-primary {
      background-color: #1e40af;
      color: white;
    }

    .button-primary:hover {
      background-color: #1e3a8a;
    }

    .button-danger {
      background-color: #dc2626;
      color: white;
    }

    .button-danger:hover {
      background-color: #b91c1c;
    }

    .message {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
    }

    .message.success {
      background-color: #dcfce7;
      color: #15803d;
    }

    .message.error {
      background-color: #fee2e2;
      color: #b91c1c;
    }

    .generated-prompt {
      margin-top: 20px;
      padding: 15px;
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      white-space: pre-wrap;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      h1 {
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Penjana Prompt Penyelidikan</h1>

    <div class="section">
      <h2>Pilihan Prompt</h2>
      <div class="form-group">
        <label for="jenisSiasatan">Jenis Siasatan</label>
        <select id="jenisSiasatan">
          <option value="">Pilih...</option>
          <option value="Kuantitatif">Kuantitatif</option>
          <option value="Kualitatif">Kualitatif</option>
          <option value="Kaedah Campuran">Kaedah Campuran</option>
        </select>
      </div>
      <div class="form-group">
        <label for="tujuanUtamaSiasatan">Tujuan Utama Siasatan</label>
        <select id="tujuanUtamaSiasatan">
          <option value="">Pilih...</option>
          <option value="Mendedahkan Fakta Kes Jenayah">Mendedahkan Fakta Kes Jenayah</option>
          <option value="Penyelidikan Kewartawanan Mendalam">Penyelidikan Kewartawanan Mendalam</option>
          <option value="Analisis Risikan">Analisis Risikan</option>
          <option value="Pemeriksaan Latar Belakang">Pemeriksaan Latar Belakang</option>
          <option value="Kajian Kes Akademik">Kajian Kes Akademik</option>
          <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
        </select>
        <input type="text" id="customTujuanUtamaSiasatan" class="custom-input" placeholder="Tulis tujuan anda..." style="display: none;">
      </div>
      <div class="form-group">
        <label for="jenisMaklumat">Jenis Maklumat yang Dicari</label>
        <select id="jenisMaklumat">
          <option value="">Pilih...</option>
          <option value="Alibi dan Garis Masa Kejadian">Alibi dan Garis Masa Kejadian</option>
          <option value="Motif Pelaku/Subjek">Motif Pelaku/Subjek</option>
          <option value="Hubungan Antara Individu/Entiti">Hubungan Antara Individu/Entiti</option>
          <option value="Analisis Bukti Fizikal dan Digital">Analisis Bukti Fizikal dan Digital</option>
          <option value="Pemeriksaan Laporan Kewangan">Pemeriksaan Laporan Kewangan</option>
          <option value="Pengecaman Corak Tingkah Laku">Pengecaman Corak Tingkah Laku</option>
          <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
        </select>
        <input type="text" id="customJenisMaklumat" class="custom-input" placeholder="Tulis jenis maklumat anda..." style="display: none;">
      </div>
      <div class="form-group">
        <label for="sumberMaklumat">Sumber Maklumat Utama</label>
        <select id="sumberMaklumat">
          <option value="">Pilih...</option>
          <option value="Temu Bual Saksi/Subjek">Temu Bual Saksi/Subjek</option>
          <option value="Dokumen Rasmi (Laporan Polis, Mahkamah)">Dokumen Rasmi (Laporan Polis, Mahkamah)</option>
          <option value="Jejak Digital (Media Sosial, E-mel)">Jejak Digital (Media Sosial, E-mel)</option>
          <option value="Laporan Kewangan/Perbankan">Laporan Kewangan/Perbankan</option>
          <option value="Rakaman CCTV/Audio">Rakaman CCTV/Audio</option>
          <option value="Data Risikan Sumber Terbuka (OSINT)">Data Risikan Sumber Terbuka (OSINT)</option>
          <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
        </select>
        <input type="text" id="customSumberMaklumat" class="custom-input" placeholder="Tulis sumber maklumat anda..." style="display: none;">
      </div>
      <div class="form-group">
        <label for="gayaBahasaNada">Gaya Bahasa dan Nada</label>
        <select id="gayaBahasaNada">
          <option value="">Pilih...</option>
          <option value="Formal dan Objektif">Formal dan Objektif</option>
          <option value="Interogatif dan Menyelidik">Interogatif dan Menyelidik</option>
          <option value="Analitikal dan Kritis">Analitikal dan Kritis</option>
          <option value="Naratif dan Deskriptif">Naratif dan Deskriptif</option>
          <option value="Persuasif (untuk laporan)">Persuasif (untuk laporan)</option>
          <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
        </select>
        <input type="text" id="customGayaBahasaNada" class="custom-input" placeholder="Tulis gaya bahasa anda..." style="display: none;">
      </div>
      <div class="form-group">
        <label for="strukturGesa">Struktur Analisis/Gesa</label>
        <select id="strukturGesa">
          <option value="">Pilih...</option>
          <option value="Soalan 5W+1H (Siapa, Apa, Bila, Di Mana, Mengapa, Bagaimana)">Soalan 5W+1H (Siapa, Apa, Bila, Di Mana, Mengapa, Bagaimana)</option>
          <option value="Analisis Kronologi Kejadian">Analisis Kronologi Kejadian</option>
          <option value="Analisis Rangkaian dan Hubungan">Analisis Rangkaian dan Hubungan</option>
          <option value="Pembinaan dan Pengujian Hipotesis">Pembinaan dan Pengujian Hipotesis</option>
          <option value="Pengecaman Kejanggalan dan Ketidakselarasan">Pengecaman Kejanggalan dan Ketidakselarasan</option>
          <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
        </select>
        <input type="text" id="customStrukturGesa" class="custom-input" placeholder="Tulis struktur gesa anda..." style="display: none;">
      </div>
      <div class="form-group">
        <label for="formatOutput">Format Output yang Dikehendaki</label>
        <select id="formatOutput">
          <option value="">Pilih...</option>
          <option value="Ringkasan Laporan Siasatan">Ringkasan Laporan Siasatan</option>
          <option value="Senarai Soalan untuk Temu Bual">Senarai Soalan untuk Temu Bual</option>
          <option value="Garis Masa Kejadian Terperinci">Garis Masa Kejadian Terperinci</option>
          <option value="Analisis Profil Subjek/Entiti">Analisis Profil Subjek/Entiti</option>
          <option value="Draf Artikel Kewartawanan">Draf Artikel Kewartawanan</option>
          <option value="Isi-isi Penting untuk Pembentangan">Isi-isi Penting untuk Pembentangan</option>
          <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
        </select>
        <input type="text" id="customFormatOutput" class="custom-input" placeholder="Tulis format output anda..." style="display: none;">
      </div>
    </div>

    <div class="section">
      <h2>Subjek/Entiti Siasatan</h2>
      <div id="subjects"></div>
      <button class="button button-primary" onclick="addSubject()">Tambah Subjek</button>
    </div>

    <div class="section">
      <h2>Butiran Penting atau Arahan Khusus</h2>
      <div id="details"></div>
      <button class="button button-primary" onclick="addDetail()">Tambah Butiran Penting</button>
    </div>

    <div class="section">
      <button class="button button-primary" onclick="generatePrompt()">Jana Prompt</button>
      <button class="button button-primary" onclick="copyPrompt()">Salin Prompt</button>
    </div>

    <div id="message" class="message" style="display: none;"></div>
    <div id="generatedPrompt" class="generated-prompt" style="display: none;"></div>
  </div>

  <script>
    // State management
    let state = {
      jenisSiasatan: '',
      tujuanUtamaSiasatan: '',
      customTujuanUtamaSiasatan: '',
      jenisMaklumat: '',
      customJenisMaklumat: '',
      sumberMaklumat: '',
      customSumberMaklumat: '',
      gayaBahasaNada: '',
      customGayaBahasaNada: '',
      strukturGesa: '',
      customStrukturGesa: '',
      formatOutput: '',
      customFormatOutput: '',
      subjekSiasatan: [],
      butiranPenting: []
    };

    // Generate unique ID
    function generateUniqueId() {
      return `id-${Math.random().toString(36).substr(2, 9)}`;
    }

    // Toggle custom input visibility
    function toggleCustomInput(selectId, inputId) {
      const select = document.getElementById(selectId);
      const input = document.getElementById(inputId);
      input.style.display = select.value === 'Lain-lain (Tulis Sendiri)' ? 'block' : 'none';
    }

    // Initialize event listeners for dropdowns
    ['tujuanUtamaSiasatan', 'jenisMaklumat', 'sumberMaklumat', 'gayaBahasaNada', 'strukturGesa', 'formatOutput'].forEach(field => {
      const select = document.getElementById(field);
      select.addEventListener('change', (e) => {
        state[field] = e.target.value;
        toggleCustomInput(field, `custom${field.charAt(0).toUpperCase() + field.slice(1)}`);
        if (e.target.value !== 'Lain-lain (Tulis Sendiri)') {
          state[`custom${field.charAt(0).toUpperCase() + field.slice(1)}`] = '';
        }
      });
      document.getElementById(`custom${field.charAt(0).toUpperCase() + field.slice(1)}`).addEventListener('input', (e) => {
        state[`custom${field.charAt(0).toUpperCase() + field.slice(1)}`] = e.target.value;
      });
    });

    document.getElementById('jenisSiasatan').addEventListener('change', (e) => {
      state.jenisSiasatan = e.target.value;
    });

    // Add subject
    function addSubject() {
      const id = generateUniqueId();
      state.subjekSiasatan.push({ id, nama: '', peranan: '', customPeranan: '', latarBelakang: '' });
      renderSubjects();
    }

    // Remove subject
    function removeSubject(id) {
      state.subjekSiasatan = state.subjekSiasatan.filter(subject => subject.id !== id);
      renderSubjects();
    }

    // Render subjects
    function renderSubjects() {
      const subjectsContainer = document.getElementById('subjects');
      subjectsContainer.innerHTML = '';
      state.subjekSiasatan.forEach((subject, index) => {
        const subjectDiv = document.createElement('div');
        subjectDiv.className = 'subject';
        subjectDiv.innerHTML = `
          <h3>Subjek ${index + 1}</h3>
          <div class="form-group">
            <label for="nama-${subject.id}">Nama</label>
            <input type="text" id="nama-${subject.id}" value="${subject.nama}" placeholder="Nama subjek...">
          </div>
          <div class="form-group">
            <label for="peranan-${subject.id}">Peranan</label>
            <select id="peranan-${subject.id}">
              <option value="">Pilih...</option>
              <option value="Suspek">Suspek</option>
              <option value="Saksi">Saksi</option>
              <option value="Mangsa">Mangsa</option>
              <option value="Orang yang Disiasat">Orang yang Disiasat</option>
              <option value="Sumber Maklumat">Sumber Maklumat</option>
              <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
            </select>
            <input type="text" id="customPeranan-${subject.id}" class="custom-input" placeholder="Tulis peranan anda..." style="display: none;">
          </div>
          <div class="form-group">
            <label for="latarBelakang-${subject.id}">Latar Belakang</label>
            <input type="text" id="latarBelakang-${subject.id}" value="${subject.latarBelakang}" placeholder="Latar belakang subjek...">
          </div>
          <button class="button button-danger" onclick="removeSubject('${subject.id}')">Padam</button>
        `;
        subjectsContainer.appendChild(subjectDiv);

        // Event listeners for subject inputs
        document.getElementById(`nama-${subject.id}`).addEventListener('input', (e) => {
          subject.nama = e.target.value;
        });
        document.getElementById(`peranan-${subject.id}`).addEventListener('change', (e) => {
          subject.peranan = e.target.value;
          toggleCustomInput(`peranan-${subject.id}`, `customPeranan-${subject.id}`);
          if (e.target.value !== 'Lain-lain (Tulis Sendiri)') {
            subject.customPeranan = '';
          }
        });
        document.getElementById(`customPeranan-${subject.id}`).addEventListener('input', (e) => {
          subject.customPeranan = e.target.value;
        });
        document.getElementById(`latarBelakang-${subject.id}`).addEventListener('input', (e) => {
          subject.latarBelakang = e.target.value;
        });
      });
    }

    // Add detail
    function addDetail() {
      const id = generateUniqueId();
      state.butiranPenting.push({ id, value: '', custom: '' });
      renderDetails();
    }

    // Remove detail
    function removeDetail(id) {
      state.butiranPenting = state.butiranPenting.filter(detail => detail.id !== id);
      renderDetails();
    }

    // Render details
    function renderDetails() {
      const detailsContainer = document.getElementById('details');
      detailsContainer.innerHTML = '';
      state.butiranPenting.forEach((detail, index) => {
        const detailDiv = document.createElement('div');
        detailDiv.className = 'detail';
        detailDiv.innerHTML = `
          <div class="form-group">
            <label for="butiranPenting-${detail.id}">Butiran Penting ${index + 1}</label>
            <select id="butiranPenting-${detail.id}">
              <option value="">Pilih...</option>
              <option value="Fokus pada hubungan kewangan antara subjek A dan B">Fokus pada hubungan kewangan antara subjek A dan B</option>
              <option value="Cari kemungkinan alibi palsu">Cari kemungkinan alibi palsu</option>
              <option value="Analisis siaran media sosial dalam 3 bulan terakhir">Analisis siaran media sosial dalam 3 bulan terakhir</option>
              <option value="Kecam kemungkinan motif balas dendam">Kecam kemungkinan motif balas dendam</option>
              <option value="Bandingkan keterangan saksi A dan saksi B">Bandingkan keterangan saksi A dan saksi B</option>
              <option value="Lain-lain (Tulis Sendiri)">Lain-lain (Tulis Sendiri)</option>
            </select>
            <input type="text" id="customButiranPenting-${detail.id}" class="custom-input" placeholder="Tulis butiran penting anda..." style="display: none;">
          </div>
          ${state.butiranPenting.length > 1 ? `<button class="button button-danger" onclick="removeDetail('${detail.id}')">Padam</button>` : ''}
        `;
        detailsContainer.appendChild(detailDiv);

        // Event listeners for detail inputs
        document.getElementById(`butiranPenting-${detail.id}`).addEventListener('change', (e) => {
          detail.value = e.target.value;
          toggleCustomInput(`butiranPenting-${detail.id}`, `customButiranPenting-${detail.id}`);
          if (e.target.value !== 'Lain-lain (Tulis Sendiri)') {
            detail.custom = '';
          }
        });
        document.getElementById(`customButiranPenting-${detail.id}`).addEventListener('input', (e) => {
          detail.custom = e.target.value;
        });
      });
    }

    // Generate prompt
    function generatePrompt() {
      const parts = [];

      const getValue = (field) => {
        const selectedValue = state[field];
        if (field === 'jenisSiasatan') {
          return selectedValue;
        }
        const customValue = state[`custom${field.charAt(0).toUpperCase() + field.slice(1)}`];
        return selectedValue === 'Lain-lain (Tulis Sendiri)' ? customValue : selectedValue;
      };

      const getSubjekDetails = (subjek) => {
        const details = [];
        if (subjek.nama) details.push(`Nama: ${subjek.nama}`);
        if (subjek.peranan) details.push(`Peranan: ${subjek.peranan === 'Lain-lain (Tulis Sendiri)' ? subjek.customPeranan : subjek.peranan}`);
        if (subjek.latarBelakang) details.push(`Latar Belakang: ${subjek.latarBelakang}`);
        return details.join(', ');
      };

      parts.push("Anda ialah seorang pembantu siasatan AI yang pakar. Berdasarkan maklumat berikut, jana output yang diminta.");
      parts.push("---");

      const appendIfPresent = (label, value) => {
        if (value) parts.push(`**${label}:** ${value}`);
      };

      appendIfPresent('Jenis Siasatan', getValue('jenisSiasatan'));
      appendIfPresent('Tujuan Utama Siasatan', getValue('tujuanUtamaSiasatan'));
      appendIfPresent('Jenis Maklumat yang Dicari', getValue('jenisMaklumat'));
      appendIfPresent('Sumber Maklumat Utama', getValue('sumberMaklumat'));
      appendIfPresent('Gaya Bahasa dan Nada', getValue('gayaBahasaNada'));
      appendIfPresent('Struktur Analisis/Gesa', getValue('strukturGesa'));
      appendIfPresent('Format Output yang Dikehendaki', getValue('formatOutput'));

      if (state.subjekSiasatan.length > 0) {
        parts.push("\n**Subjek/Entiti Utama:**");
        state.subjekSiasatan.forEach((subjek, index) => {
          const details = getSubjekDetails(subjek);
          if (details) parts.push(`- Subjek ${index + 1}: ${details}`);
        });
      }

      const butiranPentingValues = state.butiranPenting
        .map(item => (item.value === 'Lain-lain (Tulis Sendiri)' ? item.custom : item.value))
        .filter(Boolean);
      if (butiranPentingValues.length > 0) {
        parts.push("\n**Butiran Penting atau Arahan Khusus:**");
        butiranPentingValues.forEach(detail => parts.push(`- ${detail}`));
      }

      parts.push("\n---");
      parts.push("Sila proses permintaan ini secara komprehensif dan terperinci.");

      const promptText = parts.filter(Boolean).join('\n');
      const generatedPrompt = document.getElementById('generatedPrompt');
      generatedPrompt.style.display = 'block';
      generatedPrompt.textContent = promptText;

      const message = document.getElementById('message');
      message.className = 'message success';
      message.style.display = 'block';
      message.textContent = 'Prompt berjaya dijana!';
    }

    // Copy prompt to clipboard
    function copyPrompt() {
      const generatedPrompt = document.getElementById('generatedPrompt');
      if (!generatedPrompt.textContent) {
        const message = document.getElementById('message');
        message.className = 'message error';
        message.style.display = 'block';
        message.textContent = 'Tiada prompt untuk disalin. Sila jana prompt terlebih dahulu.';
        return;
      }

      const textarea = document.createElement('textarea');
      textarea.value = generatedPrompt.textContent;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        const message = document.getElementById('message');
        message.className = 'message success';
        message.style.display = 'block';
        message.textContent = 'Prompt berjaya disalin ke papan keratan!';
      } catch (err) {
        const message = document.getElementById('message');
        message.className = 'message error';
        message.style.display = 'block';
        message.textContent = 'Gagal menyalin prompt.';
      }
      document.body.removeChild(textarea);
    }

    // Initialize with one detail
    addDetail();
  </script>
</body>
</html>
